# ğŸ”„ CloudTrail + EventBridge: Reacting to AWS API Calls in Near Real-Time

Amazon **CloudTrail** tracks every API call made in your AWS account, while **EventBridge** lets you act on those calls by routing them to automation targets like **Lambda, SNS, or SQS**.

This integration enables **event-driven automation** for governance, security, compliance, and operations workflows.

---

<div align="center">
  <img src="images/cloudtrail-eventbridge.png" alt="CloudTrail to EventBridge" style="border-radius: 10px; width: 80%;">
</div>

---

## ğŸ“Œ What Happens Under the Hood?

1. **CloudTrail** records an API activity (e.g., user launches an EC2 instance).
2. That API activity is sent to **EventBridge** as an event (within \~15 minutes).
3. **EventBridge** evaluates the event against its rules.
4. If a rule matches, the event is forwarded to one or more targets:

   - âœ… **Lambda** â€“ run automation code
   - âœ… **SNS** â€“ send alert/notification
   - âœ… **SQS** â€“ enqueue for downstream processing

---

## ğŸ•’ Timing & Delivery

| Feature                      | Detail                               |
| ---------------------------- | ------------------------------------ |
| CloudTrail EventBus Delivery | \~15 minutes after the API call      |
| CloudTrail Log File to S3    | Every 5 minutes                      |
| Supported Format             | JSON via CloudTrail API Event Format |

So, while itâ€™s not **real-time**, itâ€™s **fast enough for many operational & security automations**.

---

## âš™ï¸ Use Cases

| ğŸ§  Use Case               | Example                                                                |
| ------------------------- | ---------------------------------------------------------------------- |
| ğŸ›¡ï¸ Security Alert         | Detect if a root user logs in, trigger SNS alert                       |
| ğŸ” Compliance Enforcement | Prevent certain IAM roles from being created automatically             |
| ğŸ’¸ Cost Optimization      | Detect launching of large EC2 instances, auto-tag or notify via Lambda |
| ğŸ“¦ Operational Automation | React to bucket creation by running custom Lambda                      |

---

## ğŸ§ª Hands-On: Monitor EC2 Instance Launches

### ğŸ›  Step 1: Enable CloudTrail

- Go to **CloudTrail Console**
- Create a new trail (if not done)
- Enable **management events**

### ğŸ›  Step 2: Create EventBridge Rule

- Go to **Amazon EventBridge â†’ Rules**
- Create a new rule with the following pattern:

  ```json
  {
    "source": ["aws.ec2"],
    "detail-type": ["AWS API Call via CloudTrail"],
    "detail": {
      "eventName": ["RunInstances"]
    }
  }
  ```

- Target: **SNS / Lambda / SQS**

---

## ğŸ” Tips for Security & Efficiency

- Use **EventBridge filters** to avoid triggering rules for every API call
- Combine with **CloudTrail Insights** to catch anomalies
- Keep CloudTrail logs archived in **S3 + Glacier** for audit
- Protect trails with **digest validation**, **S3 bucket encryption**, and **MFA delete**

---

## âœ… Summary

**CloudTrail + EventBridge** helps you:

- Monitor critical activity
- Automate reactions
- Build event-driven systems
- Strengthen security posture

> You don't just log what happened â€” you react to it ğŸ”.
