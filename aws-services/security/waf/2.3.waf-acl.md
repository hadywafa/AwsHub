# ðŸ§± **AWS WAF Web ACLs: Your Traffic Gatekeeper**

> _Define the security rules for your applications and APIs â€” inspect every request, allow the good, block the bad._

---

<div align="center" style="padding: 0 20px;">
  <img src="images/aws-waf-web-acl.png" alt="AWS WAF Web ACL Overview" style="border-radius: 16px; width: 75%;" />
</div>

---

## ðŸŒŸ **What is a Web ACL in AWS WAF?**

A **Web ACL (Web Access Control List)** is the **main building block** in AWS WAF.

âœ… Itâ€™s a **set of rules** that decides:

- ðŸ“¥ Which HTTP/S requests to **Allow**
- ðŸš« Which requests to **Block**
- ðŸ“Š Which requests to simply **Count** (for monitoring)
- ðŸ¤– Whether to **Challenge (CAPTCHA)** or **Verify (Challenge)** users

âœ… You **attach** a Web ACL to your AWS resources like:

- **CloudFront distributions**
- **Application Load Balancers (ALB)**
- **API Gateway endpoints**
- **AWS AppSync APIs**
- **Amazon Cognito user pools**

---

## ðŸ› ï¸ **How AWS WAF Web ACLs Work**

```mermaid
flowchart TD
    A[Incoming HTTP/S Request] --> B[WAF Web ACL]
    B --> C{Match any rule?}
    C -- Yes --> D["Apply matching rule action (Allow, Block, Count, CAPTCHA)"]
    C -- No --> E[Apply Default Action (Allow/Block)]
```

âœ… **WAF Web ACL** acts like a **filtering gate** at the very first step before your app handles anything.

---

## ðŸ”Ž **Main Components of a Web ACL**

| Component             | Description                                                         |
| :-------------------- | :------------------------------------------------------------------ |
| ðŸ§± **Web ACL**        | The container that holds and orders rules                           |
| ðŸ“œ **Rules**          | Conditions that inspect parts of requests (headers, IP, body, etc.) |
| ðŸ“š **Rule Groups**    | Bundles of rules (AWS Managed or your own)                          |
| ðŸ”¢ **Priority Order** | Rules are evaluated in order â€” first match wins                     |
| âš™ï¸ **Default Action** | What happens if no rules match (Allow or Block)                     |
| ðŸŽ¯ **Rule Actions**   | Allow, Block, Count, CAPTCHA, Challenge                             |

---

## âœ¨ **Actions a Rule Can Perform**

| Action           | Purpose                                             |
| :--------------- | :-------------------------------------------------- |
| âœ… **Allow**     | Let the request through                             |
| ðŸš« **Block**     | Reject the request with a 403 Forbidden             |
| ðŸ“Š **Count**     | Do not affect the request but log it for monitoring |
| ðŸ¤– **CAPTCHA**   | Present a CAPTCHA challenge before allowing         |
| ðŸ§© **Challenge** | Advanced browser verification (beyond CAPTCHA)      |

---

## ðŸªœ **Web ACL Evaluation Flow (Step-by-Step)**

1. Request reaches your resource (CloudFront/ALB/API Gateway).
2. WAF evaluates request **against each rule** in Web ACL in priority order.
3. First matching rule **decides the action** (Allow/Block/Count/Challenge).
4. If no rule matches, **Default Action** (Allow or Block) applies.
5. WAF logs decision (if configured) to **S3**, **CloudWatch Logs**, or **Kinesis Data Firehose**.

---

## ðŸŽ¯ **Example: Simple Web ACL Structure**

| Priority | Rule Name              | Condition                                     | Action |
| :------- | :--------------------- | :-------------------------------------------- | :----- |
| 1        | BlockBadIPs            | IP set match (blocked IP list)                | Block  |
| 2        | SQLInjectionProtection | SQLi patterns detected in body/query          | Block  |
| 3        | RateLimitAPI           | More than 1000 requests per 5 minutes from IP | Block  |
| 4        | AllowAllOthers         | Default                                       | Allow  |

âœ… Requests are evaluated **top to bottom**.

---

## ðŸ“š **Common Web ACL Rules You Can Create**

| Rule Type                   | Example Use                                                  |
| :-------------------------- | :----------------------------------------------------------- |
| ðŸš« **IP Set Rules**         | Block specific IP addresses or CIDR ranges                   |
| ðŸ›¡ï¸ **AWS Managed Rules**    | Use pre-built rules against common threats like OWASP Top 10 |
| âœï¸ **String Match Rules**   | Block requests containing suspicious keywords                |
| ðŸ› **SQLi/XSS Match Rules** | Block SQL Injection and Cross-Site Scripting                 |
| ðŸŒ **Geo Match Rules**      | Allow or block countries or regions                          |
| ðŸš€ **Rate-Based Rules**     | Automatically block abusive traffic                          |

---

## ðŸŒŽ **Web ACL Use Cases**

| Use Case                                    | How Web ACL Helps                          |
| :------------------------------------------ | :----------------------------------------- |
| ðŸ”¥ **Protect Against OWASP Top 10 Threats** | Use Managed Rule Groups (SQLi, XSS, etc.)  |
| ðŸš€ **Control API Abuse**                    | Enforce request rate limits                |
| ðŸŒ **Restrict Geographic Access**           | Allow/block based on user locations        |
| ðŸ¤– **Filter Bots**                          | Apply CAPTCHA or block bad bots            |
| ðŸ›¡ï¸ **Custom Business Logic**                | Create your own rules for specific threats |

---

## ðŸ“ˆ **Monitoring Web ACLs**

- **Metrics** are pushed to **Amazon CloudWatch** automatically:
  - AllowedRequests
  - BlockedRequests
  - CountedRequests
- **Detailed logs** can be sent to:
  - **S3** (archival analysis)
  - **CloudWatch Logs** (real-time dashboards)
  - **Kinesis Data Firehose** (advanced pipelines)

âœ… You can **visualize** how your Web ACL protects your apps!

---

## ðŸ’° **Pricing Overview**

| Item                          | Cost                                             |
| :---------------------------- | :----------------------------------------------- |
| **Web ACL Monthly Charge**    | Based on number of Web ACLs                      |
| **Per Rule Charge**           | Based on number of rules per Web ACL             |
| **Request Inspection Charge** | Based on the number of HTTP/S requests evaluated |

âœ… **Pay for what you use** â€” no upfront commitment.

---

## ðŸ† **Final Smart Pro Tip**

> ðŸ§  **Start with AWS Managed Rule Groups for fast protection. Then layer your own custom rules as you learn more about your application's traffic patterns.**

âœ… Managed rules save time  
âœ… Custom rules add precision  
âœ… Combined = Best defense!
