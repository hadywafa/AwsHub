# ğŸ” **CloudFront Security: OAC vs. Signed URLs vs. Signed Cookies**

## ğŸ§  **What Is â€œPrivate Contentâ€?**

> Content that you want to restrict access to, such as:

- ğŸ¥ Paid videos
- ğŸ“„ Confidential documents
- ğŸ”’ Customer-specific downloads

CloudFront supports **two layers of protection**:

| Purpose                                   | Solution                         |
| ----------------------------------------- | -------------------------------- |
| Prevent **direct origin access**          | âœ… Origin Access Control (OAC)   |
| Restrict **viewer access via CloudFront** | âœ… Signed URLs or Signed Cookies |

---

| Feature                            | Purpose                                                               |
| ---------------------------------- | --------------------------------------------------------------------- |
| **ğŸ§  OAC (Origin Access Control)** | Control **how CloudFront talks to your origin (e.g., S3)** securely   |
| **ğŸ”‘ Signed URLs/Cookies**         | Control **who can access CloudFront content** (viewer-level security) |

---

## ğŸ” They solve **two different problems**

### ğŸ” **1. Origin Access Control (OAC)**

> Prevents users from **bypassing CloudFront** and directly accessing your S3 bucket.  
> Think of it as: `"CloudFront --â†’ S3 pipe security"`

### âœ… Key Role

- CloudFront signs each **origin request** using SigV4.
- Your S3 bucket blocks all public access.
- Only CloudFront (with the correct OAC) can fetch content from the origin.

---

### ğŸ”‘ **2. Signed URL / Signed Cookie**

> Controls which **viewers/users** can access CloudFront content.  
> Think of it as: `"User --â†’ CloudFront viewer access"`

### âœ… Key Role

- You generate a **temporary, signed URL** (or a cookie) with an expiration time.
- Users without the signature **canâ€™t access** the content via CloudFront.
- Used for **paid/private downloads**, streaming, memberships, etc.

---

## ğŸ§­ Sequence Comparison

### ğŸ” With OAC (no signed URL)

<div align="center">

```mermaid
sequenceDiagram
    participant ğŸ‘¤ as ğŸ‘¤ User
    participant ğŸŒ as ğŸŒCloudFront
    participant ğŸª£ as ğŸª£ S3 (Private)

    ğŸ‘¤->>ğŸŒ: GET /video.mp4
    ğŸŒ->>ğŸª£: Signed request via OAC (SigV4)
    ğŸª£-->>ğŸŒ: Returns object
    ğŸŒ-->>ğŸ‘¤: Delivers content
```

> Viewer can access **any cached file**  
> No restrictions on **who** the viewer is

</div>

---

### ğŸ”‘ With Signed URL

<div align="center">

```mermaid
sequenceDiagram
    participant ğŸ‘¤ as ğŸ‘¤ User
    participant ğŸŒ as ğŸŒ CloudFront

    ğŸ‘¤->>ğŸŒ: GET /video.mp4?Signature=xyz&Expires=abc
    alt Signature valid
        ğŸŒ-->>ğŸ‘¤: Delivers content âœ…
    else
        ğŸŒ-->>ğŸ‘¤: 403 Forbidden âŒ
    end
```

> Viewer **must have a valid signature**
> Used for **download access control**

</div>

---

## ğŸ§  TL;DR â€“ When to Use What?

| Goal                             | Use                               |
| -------------------------------- | --------------------------------- |
| ğŸ” Keep S3 bucket private        | âœ… Use **OAC**                    |
| ğŸ”‘ Restrict who can access files | âœ… Use **Signed URLs or Cookies** |
| ğŸ¯ Do both                       | âœ… Combine both                   |

---

## âœ… Combine Both for Full Security

| Layer        | Tool              | What It Does                  |
| ------------ | ----------------- | ----------------------------- |
| Viewer â†’ CDN | Signed URL/Cookie | Only authorized users allowed |
| CDN â†’ Origin | OAC               | Only CloudFront can reach S3  |
