# ğŸ›‘ **Restricting S3 Bucket Access to CloudFront Only (Using Origin Access Control - OAC)**

> _Ensure your S3 bucket content is **served only through CloudFront**, not accessible directly over the internet._

---

## ğŸ” **What Is Origin Access Control (OAC)?**

**Origin Access Control (OAC)** is the modern, more flexible replacement for Origin Access Identity (OAI). It lets **CloudFront securely access private S3 buckets** by signing requests and authenticating using IAM-style policies.

âœ… Use OAC when your S3 bucket is **not a static website endpoint** (i.e., use a **REST API-style S3 bucket**).

---

## âš™ï¸ **How OAC Works â€“ Behind the Scenes**

ğŸ”’ **CloudFront signs requests** to the S3 bucket on your behalf.

ğŸ“œ **S3 bucket policy** allows access only if:

- The request is **signed by CloudFront**
- The request **matches the CloudFront distributionâ€™s ARN**

âŒ **No public access needed** â€” `Block Public Access` can stay **fully enabled**.

---

<div align="center">
  <img src="images/s3-cloudfront-oac.png" alt="CloudFront OAC S3" style="border-radius: 10px; width: 40%;">
</div>

---

## ğŸ”‘ **OAC Signing Behavior Options**

| Mode                        | Behavior                                                                                                 |
| --------------------------- | -------------------------------------------------------------------------------------------------------- |
| âœ… **Sign origin requests** | CloudFront **signs** each request to S3 â€” best for private access                                        |
| ğŸš« **Do not sign requests** | CloudFront sends unsigned requests â€” S3 **must be public** (not recommended)                             |
| ğŸ”„ **Pass authorization**   | CloudFront **forwards the Authorization header** from the client (used in signed URLs/cookies workflows) |

---

## ğŸ“œ **Example S3 Bucket Policy (with OAC)**

Hereâ€™s a sample policy to **allow only CloudFront** (via OAC) to get objects from the bucket:

```json
{
  "Version": "2012-10-17",
  "Statement": {
    "Sid": "AllowCloudFrontReadOnly",
    "Effect": "Allow",
    "Principal": {
      "Service": "cloudfront.amazonaws.com"
    },
    "Action": "s3:GetObject",
    "Resource": "arn:aws:s3:::my-bucket-name/*",
    "Condition": {
      "StringEquals": {
        "AWS:SourceArn": "arn:aws:cloudfront::<account-id>:distribution/<distribution-id>"
      }
    }
  }
}
```

> ğŸ“Œ Replace `my-bucket-name`, `<account-id>`, and `<distribution-id>` accordingly.

---

## ğŸ’¡ **Best Practices for OAC & CloudFront with S3**

| Best Practice                            | Why It Matters                                         |
| ---------------------------------------- | ------------------------------------------------------ |
| ğŸ”’ **Block all public access**           | Ensures objects are **only accessible** via CloudFront |
| âœï¸ **Enable request signing**            | Forces CloudFront to authenticate to S3 securely       |
| ğŸ›¡ **Avoid legacy OAI if possible**       | Use **OAC**, which is more powerful and flexible       |
| ğŸ“ˆ **Monitor with CloudWatch + S3 logs** | Track access patterns and potential misconfigurations  |
| ğŸŒ **Use HTTPS only**                    | Ensure secure communication between CloudFront and S3  |

---

## âœ… **Why Use CloudFront + OAC with S3?**

- âœ… **Private content delivery** without exposing your S3 bucket to the internet
- âœ… **WAF protection, caching, geo restriction** and more â€” all managed through CloudFront
- âœ… **IAM-style policy** for fine-grained access control
- âœ… **Supports modern use cases**, unlike the older OAI approach
