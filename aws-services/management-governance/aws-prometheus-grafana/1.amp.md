# ğŸš€ **AWS Managed Prometheus (AMP)**

> _Scalable, secure, and serverless Prometheus monitoring â€” without managing infrastructure._

---

<div align="center" style="padding:20px;">
  <img src="images/amp.png" alt="AWS Managed Prometheus" style="border-radius: 16px; width: 40%;" />
</div>

---

## ğŸ¤– **What is Prometheus?**

**Prometheus** is a **powerful open-source toolkit** for:

<div align="center" style="padding:20px;">

| âœ… Feature               | ğŸ’¡ Description                                                                   |
| ------------------------ | -------------------------------------------------------------------------------- |
| ğŸ“Š **Data Collection**   | Collects and stores metrics as **time-series data** (timestamp + labels + value) |
| ğŸ§  **PromQL Language**   | Query, filter, and aggregate metrics easily using **PromQL**                     |
| ğŸ³ **Kubernetes Native** | Built for **monitoring containerized systems**, especially **Kubernetes**        |
| ğŸš¨ **Alerting**          | Integrates with **Alertmanager** to trigger alerts on defined metric conditions  |

</div>

---

<div align="center" style="padding:20px;">
  <img src="images/prometheus.png" alt="Prometheus" style="border-radius: 16px; width: 60%;" />
</div>

---

## ğŸŒ **What is AWS Managed Prometheus (AMP)?**

> **AWS Managed Prometheus (AMP)** is a **fully managed, Prometheus-compatible monitoring service** designed for Kubernetes and container-based workloads.

---

## ğŸŒŸ **Key Features of AMP**

<div align="center" style="padding:20px;">

| ğŸ§© Feature                        | âœ… Details                                                                            |
| --------------------------------- | ------------------------------------------------------------------------------------- |
| ğŸ” **Prometheus-Compatible**      | Drop-in support for Prometheus metrics format and PromQL                              |
| â˜ï¸ **Serverless Architecture**    | No need to manage Prometheus servers or storage volumes                               |
| ğŸ”’ **Secure Monitoring**          | Integrated with IAM, VPC endpoints, and encryption-at-rest                            |
| ğŸ—ï¸ **Scalable**                   | Handles **high cardinality** workloads across **millions of metrics**                 |
| ğŸ“ˆ **150-Day Retention**          | Retains ingested metrics for **up to 150 days**                                       |
| ğŸ§© **Grafana Integration**        | Pairs perfectly with **AWS Managed Grafana** to visualize metrics                     |
| ğŸ“¦ **Multi-Environment Support**  | Supports **Amazon EKS, EKS Anywhere**, ECS, EC2, and even **self-managed Kubernetes** |
| ğŸŒ **Multi-AZ High Availability** | Metric data is **replicated across 3 AZs** for resilience                             |

</div>

---

## ğŸ  **AMP Inside a VPC (Private Access)**

<div align="center" style="padding:20px;">
  <img src="images/amp-inside-vpc.png" alt="AMP Inside VPC" style="border-radius: 16px; width: 30%;" />
</div>

### ğŸ” Private Connectivity

- You can deploy **VPC interface endpoints** (via AWS PrivateLink) to connect **privately** to AMP without using public internet.
- Works seamlessly with **VPC Service Controls** and **fine-grained IAM policies**.

---

## ğŸ” **How Data Flows Into AMP**

```mermaid
sequenceDiagram
    participant K8s as Kubernetes Cluster (EKS/EKS-A/Self-managed)
    participant PromAgent as Prometheus Server/Agent
    participant AMP as AWS Managed Prometheus
    participant Grafana as AWS Managed Grafana

    K8s->>PromAgent: Collect metrics from pods/services
    PromAgent->>AMP: Remote Write metrics via HTTPS
    Grafana->>AMP: Query metrics using PromQL
    AMP-->>Grafana: Return time-series data
```

---

## ğŸ”§ **How to Use AMP (Step-by-Step)**

### âœ… 1. **Create a Workspace**

```bash
aws amp create-workspace --alias my-monitoring-env
```

### âœ… 2. **Get Endpoint**

```bash
aws amp list-workspaces
```

### âœ… 3. **Configure Remote Write (on Prometheus)**

```yaml
# prometheus.yaml
remote_write:
  - url: https://aps-workspaces.us-east-1.amazonaws.com/workspaces/ws-XXXX/api/v1/remote_write
    sigv4:
      region: us-east-1
```

> ğŸ§  You can use **AWS SigV4 Proxy** to sign requests automatically from your Prometheus setup.

### âœ… 4. **Visualize with Grafana**

- Use **AWS Managed Grafana**
- Connect it to AMP using the same region + workspace ID
- Query with **PromQL** (e.g., `rate(http_requests_total[5m])`)

---

## ğŸ› ï¸ **Example Use Cases**

| Use Case                            | AMP Benefit                               |
| ----------------------------------- | ----------------------------------------- |
| ğŸ” Monitoring EKS/ECS clusters      | Native integration with Prometheus agents |
| ğŸ’¾ Long-term metric retention       | Store metrics for up to 150 days          |
| ğŸ“Š Infrastructure visualization     | Plug into Grafana dashboards easily       |
| âš ï¸ Scalable alerting                | Alert on container CPU/memory spikes      |
| ğŸ” Secure multi-tenant environments | IAM-based access control per workspace    |

---

## ğŸ§  Summary

| âœ… Pros                                | âŒ Cons                                        |
| -------------------------------------- | ---------------------------------------------- |
| Fully managed (no Prometheus server)   | Requires setup of Prometheus remote write      |
| PromQL-compatible (no re-learning)     | Limited to metric ingestion (no Alertmanager)  |
| Highly available, secure, scalable     | Some latency in ingestion vs. local Prometheus |
| Integrates with Grafana, EKS, ECS, EC2 | Paid service; cost scales with ingestion       |
