# ğŸ§¹ 7. Data Preparation with SageMaker Data Wrangler

## ğŸ§  What is SageMaker Data Wrangler?

> **Definition**:  
> **SageMaker Data Wrangler** is a **visual data preparation tool** inside SageMaker Studio that helps you **import**, **analyze**, **transform**, **clean**, and **export** datasets for machine learning â€”  
> **without needing to write a lot of code**.

---

<div style="text-align: center;">
    <img src="images/sagemaker-data-wrangler.png" alt="sagemaker-data-wrangler" style="border-radius: 10px; width: 80%;">
</div>

---

ğŸ“Œ **Simply**:

- It's like a **magic workshop** for **cleaning and preparing data** before training your model ğŸª„.
- Everything happens in an **easy point-and-click interface** â€” but it still gives you **full control** if you want to dive into code!

ğŸ“Œ **Key Benefits**:

| Feature                   | Benefit                                                            |
| :------------------------ | :----------------------------------------------------------------- |
| Visual Interface          | Prepare datasets without heavy coding                              |
| Multiple Data Sources     | Connect to S3, RDS, Redshift, Snowflake, etc.                      |
| Pre-built Transformations | Apply common data wrangling steps easily                           |
| Data Quality Checks       | Detect missing values, outliers, and inconsistencies               |
| Export to Pipelines       | Seamlessly send data flows to SageMaker Pipelines for automated ML |

---

## ğŸ› ï¸ Core Capabilities of SageMaker Data Wrangler

### ğŸ“¥ 1. Importing Data

<div style="text-align: center;">
    <img src="images/sagemaker-data-wrangler-import-data.png" alt="sagemaker-data-wrangler-import-data" style="border-radius: 20px; width: 80%;">
</div>

---

<div style="text-align: center;">
    <img src="images/sagemaker-data-wrangler-preview-data.png" alt="sagemaker-data-wrangler-preview-data" style="border-radius: 20px; width: 80%;">
</div>

---

ğŸ“Œ **Supported Sources**:

- **Amazon S3** buckets (CSV, Parquet, JSON files).
- **Databases** like RDS, Redshift, Snowflake.
- **Athena Queries** (for querying your data lake).
- **SageMaker Feature Store** (import pre-engineered features).

ğŸ“Œ **Steps**:

- Choose a data source ğŸ¯.
- Browse or query the dataset ğŸ”.
- Preview before importing ğŸ“‹.

ğŸ“Œ **Real-World Example**:

- Pull customer transactions directly from an S3 bucket into the Wrangler workspace!

---

### ğŸ“Š 2. Visualizing Data

<div style="text-align: center;">
    <img src="images/sagemaker-data-wrangler-visualize-data.png" alt="sagemaker-data-wrangler-visualize-data" style="border-radius: 20px; width: 80%;">
</div>

---

ğŸ“Œ **Tools available**:

- Histograms ğŸ“Š.
- Scatter plots ğŸ–‹ï¸.
- Correlation matrices ğŸ”—.
- Box plots ğŸ—ƒï¸.
- Target leakage detection ğŸ“¢.

ğŸ“Œ **What you can detect**:

| Issue                     | Visual Help          |
| :------------------------ | :------------------- |
| Skewed distributions      | Histograms           |
| Outliers                  | Box plots            |
| Strongly related features | Correlation heatmaps |

ğŸ“Œ **Real-World Example**:

- Plot customer age vs purchase amount to see if a relationship exists!

ğŸ“Œ **Benefit**:

- **Detect problems early** before training a bad model!

---

### ğŸ”„ 3. Transforming Data

<div style="text-align: center;">
    <img src="images/sagemaker-data-wrangler-transform-data.png" alt="sagemaker-data-wrangler-transform-data" style="border-radius: 20px; width: 80%;">
</div>

---

ğŸ“Œ **Common Transformations** (Pre-built templates):

| Transformation          | Purpose                                    |
| :---------------------- | :----------------------------------------- |
| One-Hot Encoding        | Convert categorical variables into numeric |
| Scaling/Normalization   | Standardize numeric features               |
| Handling Missing Values | Fill in or drop missing data               |
| Date Transformations    | Extract day, month, year from timestamps   |
| Text Transformations    | Tokenization, text cleaning                |

ğŸ“Œ **Custom Transformations**:

- You can **write your own Pandas, PySpark, or SQL code** inside the visual flow when needed.

ğŸ“Œ **Real-World Example**:

- One-hot encode "payment method" field into separate features like `payment_credit`, `payment_cash`, `payment_online`.

ğŸ“Œ **Benefit**:

- Prepares **perfect features** for your model ğŸš€!

---

### âš¡ 4. Quick Model Building

<div style="text-align: center;">
    <img src="images/sagemaker-data-wrangler-quick-model.png" alt="sagemaker-data-wrangler-quick-model" style="border-radius: 20px; width: 80%;">
</div>

---

ğŸ“Œ **Quick Model**:

- After preparing data, you can **immediately run a basic AutoML model** inside Data Wrangler to:
  - Quickly test how well your data can predict a target.
  - Get an instant idea of potential **model accuracy** or **issues**.

ğŸ“Œ **Steps**:

- Select a target variable ğŸ¯.
- Launch quick model ğŸš€.
- Review results (accuracy, feature importance) ğŸ“ˆ.

ğŸ“Œ **Benefit**:

- **Early feedback** on whether your dataset is ready for real training!

---

### ğŸ“¤ 5. Exporting Data Flows

<div style="text-align: center;">
    <img src="images/sagemaker-data-wrangler-export-data.png" alt="sagemaker-data-wrangler-export-data" style="border-radius: 20px; width: 80%;">
</div>

---

ğŸ“Œ **After preparing data**, you can export it easily to:

| Export Destination        | Usage                                                      |
| :------------------------ | :--------------------------------------------------------- |
| Amazon S3                 | Save prepared dataset                                      |
| SageMaker Pipelines       | Include preprocessing step inside an automated ML pipeline |
| SageMaker Processing Jobs | Scale data preparation to large datasets                   |
| Local Disk                | Download for offline work                                  |

ğŸ“Œ **Export Includes**:

- Data Transformations
- Data Quality Reports
- Metadata

ğŸ“Œ **Real-World Example**:

- Export a fully cleaned, normalized customer dataset to SageMaker Pipelines â” then trigger model training automatically!

---

### ğŸ›¡ï¸ 6. Data Quality Tool

ğŸ“Œ **Built-in Quality Reports**:

| Check                   | Purpose                                         |
| :---------------------- | :---------------------------------------------- |
| Missing Value Detection | Identify incomplete records                     |
| Cardinality Analysis    | Spot fields with too many/too few unique values |
| Data Type Validation    | Detect incorrectly formatted fields             |
| Statistical Summary     | Get mean, median, std dev for numeric features  |

ğŸ“Œ **Benefit**:

- **Catch bad data early** before it sabotages your training! ğŸ¯

ğŸ“Œ **Example**:

- If a column "age" has negative values, Data Wrangler will flag it ğŸš¨.

---

## âœï¸ Mini Smart Recap

| Step            | Key Action                                      |
| :-------------- | :---------------------------------------------- |
| ğŸ“¥ Import       | Connect to data sources (S3, databases, Athena) |
| ğŸ“Š Visualize    | Spot trends, problems visually                  |
| ğŸ”„ Transform    | Apply pre-built or custom transformations       |
| âš¡ Quick Model  | Instantly test data quality for ML              |
| ğŸ“¤ Export       | Save cleaned data or integrate into pipelines   |
| ğŸ›¡ï¸ Data Quality | Detect missing data, outliers, errors           |

ğŸ“Œ **Simple Rule**:

> Before you "train smarter," you must "prepare smarter" â€” and **Data Wrangler makes it fun and easy**! ğŸš€
