# ğŸš€ **AWS Elastic Beanstalk (EB) â€” Complete Guide for Developers**

> Think of EB as your **â€œDevâ€™s Shortcutâ€** to deploying apps on AWS â€” without handling infrastructure the hard way!

<div align="center">
    <img src="images/aws-eb.png" alt="AWS Elastic Beanstalk" style="border-radius: 10px; width: 70%"/>
</div>

---

## ğŸŒ **What Is AWS Elastic Beanstalk?**

> **AWS Elastic Beanstalk** is a **Platform-as-a-Service (PaaS)** that lets developers deploy web apps & services **without managing infrastructure**.

ğŸ’¡ **You write the code** â†’ **Beanstalk handles the rest**:

- Provisioning EC2, Load Balancers, Auto Scaling
- Health Monitoring, Rolling Deployments
- Environment Configuration (via GUI or YAML)

Itâ€™s ideal for teams who want to focus on **features, not servers**.

---

## ğŸ“š **Key Concepts**

- **Application**: A logical collection of Elastic Beanstalk environments, versions, and configurations.
- **Application Version**: A specific iteration of your application code. Use lifecycle policies to manage old versions.
- **Environment**: A collection of AWS resources running a specific application version.
- **Environment Tier**: Specifies the application typeâ€”either a **web environment tier** (for web applications) or a **worker environment tier** (for background tasks).
- **Platform**: Combines the OS, programming language runtime, and server.

---

## ğŸ— **Environment Types**

Elastic Beanstalk supports different environment types to meet varying requirements:

- **Single Instance**: Ideal for development or testing environments to save costs.
- **Load-Balanced and Auto-Scaled**: Perfect for production environments that require high availability and scalability.
- **Auto-Scaled Only**: Designed for worker environments handling background tasks.

---

## ğŸ§  **Key Features**

| Feature                     | Description                                               |
| --------------------------- | --------------------------------------------------------- |
| ğŸ§‘â€ğŸ’» **Developer Focused** | Built for app devs â€” no deep AWS infra needed             |
| ğŸ” **Fully Managed**        | EB auto handles scaling, patching, load balancing         |
| ğŸ“¦ **Built-in Platforms**   | Support for Node.js, Python, .NET, Docker, and more       |
| ğŸ”§ **Customizable**         | Use `.ebextensions` for fine-grained config               |
| ğŸ“¤ **Code First**           | Just push your code â€” EB wraps it in infrastructure magic |

---

## ğŸ”— **Integration with AWS Services**

Elastic Beanstalk integrates seamlessly with other AWS services:

- **Amazon CloudFront**: Acts as an origin for faster content delivery.
- **API Gateway**: Serves as a backend for APIs.
- **CloudWatch Logs**: Streams application health logs for monitoring.
- **Amazon RDS**: Creates databases for your application.
- **Amazon EFS**: Provides shared file directories.
- **EventBridge**: Monitors events and triggers actions.

---

## ğŸ§ª **Supported Platforms**

| Language / Platform      | Type                        |
| ------------------------ | --------------------------- |
| Node.js, Python, Ruby    | Pre-configured runtime      |
| Java SE / Tomcat         | With JVM setup              |
| .NET Core (Linux) / .NET | Linux or Windows platform   |
| Go                       | Native support              |
| Docker (Single & Multi)  | Custom runtime environments |
| Custom Platform          | Built with Packer           |

---

## âœ… **When to Use EB**

- Small teams/startups who need fast, simplified deployments
- Developers needing PaaS features without vendor lock-in
- You want infra done-for-you, but still on AWS
- Use Docker for custom stacks (e.g., unsupported runtimes)

ğŸ›‘ **Warning**: DBs created inside EB environment **will be destroyed** if the environment is deleted.

---

## ğŸš€ Deployment Policies in EB

Elastic Beanstalk gives you **five strategies** to deploy new versions of your app:

---

### 1ï¸âƒ£ All At Once

Deploys to **all instances simultaneously**.

ğŸŸ¡ **Risk**: Downtime if anything fails  
âœ… **Fastest** deployment

<div align="center">
<img src="images/ebs-deployment-types-all-at-once.png" alt="EBS Deployment - All at Once" style="border-radius: 10px; width: 70%;">
</div>

---

### 2ï¸âƒ£ Rolling

Deploys in **batches**, replacing some instances at a time.

âœ… **Reduces downtime**  
ğŸŸ¡ Still may reduce capacity

<div align="center">
    <img src="images/ebs-deployment-types-rolling.png" alt="EBS Deployment - Rolling" style="border-radius: 10px; width: 70%;">
</div>

---

### 3ï¸âƒ£ Rolling with Additional Batch

Same as above, but **adds extra instances** during deployment.

âœ… Keeps full capacity  
ğŸŸ¥ Uses **more resources** temporarily

<div align="center">
    <img src="images/ebs-deployment-types-rolling-with-additional-batch.png" alt="EBS Deployment - Rolling with Additional Batch" style="border-radius: 10px; width: 70%;">
</div>

---

### 4ï¸âƒ£ Immutable

Creates **new instances with the new version**, swaps them in.

âœ… Safer than rolling  
âœ… No downtime  
ğŸŸ¥ Slower & more costly

<div align="center">
    <img src="images/ebs-deployment-types-immutable.png" alt="EBS Deployment - Immutable" style="border-radius: 10px; width: 70%;">
</div>

---

### 5ï¸âƒ£ Traffic Splitting

Split traffic between **new and old versions** for **canary testing**.

âœ… Controlled testing  
âœ… Safe rollback  
ğŸŸ¥ Complex monitoring setup needed

<div align="center">
    <img src="images/ebs-deployment-types-traffic-split.png" alt="EBS Deployment - Traffic Splitting" style="border-radius: 10px; width: 70%;">
</div>

---

## ğŸ”µ **Blue/Green Deployments in EB**

âœ… Zero-downtime updates  
âœ… Rollback = instant  
ğŸŸ¥ Double infra = double cost (temporarily)

<div align="center">
    <img src="images/aws-eb-blue-green.png" alt="AWS Elastic Beanstalk Blue/Green Deployment" style="border-radius: 10px; width: 70%;">
</div>

ğŸ“Œ **Steps:**

1. Create a copy (green) of your existing EB environment (blue)
2. Deploy new version to green
3. Swap CNAME when ready
4. Roll back by swapping again if needed

---

## ğŸ’¾ **Elastic Beanstalk + RDS: All Deployment Options Explained**

Elastic Beanstalk does **not manage your database** directly â€” it just connects to one. But the way you create and connect your RDS instance matters **a lot** depending on your goals (like preserving data).

Letâ€™s break down each option ğŸ’¥

---

### â˜ï¸ Option 1 â€“ **RDS Created _Inside_ the EB Environment**

| âœ… Pros                      | âŒ Cons                                  |
| ---------------------------- | ---------------------------------------- |
| Automatic setup              | **Tightly coupled** to EB environment    |
| Easy connection via env vars | Deleting EB = deleting **your database** |
| Simple for dev/test          | Not safe for production                  |

ğŸ§  **What happens?**

- When you create a new Elastic Beanstalk environment (via Console or CLI), you can **enable a database** (e.g., RDS MySQL).
- EB provisions an **RDS instance automatically**, and injects env vars like:

  ```bash
  RDS_HOSTNAME, RDS_PORT, RDS_USERNAME, RDS_PASSWORD
  ```

- EB links this RDS to your environment **stack (CloudFormation)**.

ğŸ”¥ **BUT**: When you delete the environment (even by mistake), AWS deletes the **entire stack**, including the database â€” ğŸ”¥ **data loss!**

> ğŸ§ª **Best for**: Dev/test environments where you donâ€™t mind wiping the DB when the app is gone.

---

### âœŒï¸ Option 2 â€“ **RDS Created _Outside_ of EB (Recommended for Production)**

| âœ… Pros                                   | âŒ Cons                      |
| ----------------------------------------- | ---------------------------- |
| **Persistent data** even if EB is deleted | Must manually provision RDS  |
| Use snapshots, scaling, backups           | Slightly more setup upfront  |
| Supports multiple EB envs                 | Not included in EB lifecycle |

ğŸ§  **What happens?**

- You manually create an RDS instance using:
  - AWS Console
  - CloudFormation
  - Terraform
  - or CLI (`aws rds create-db-instance`)
- You then connect it by injecting **custom environment variables** into your EB app:

  ```bash
  RDS_HOSTNAME = mydb.abcdefg1234.us-east-1.rds.amazonaws.com
  RDS_USERNAME = myuser
  RDS_PASSWORD = mypass
  ```

- These are added either via:
  - Console â†’ Configuration â†’ Environment properties
  - `.ebextensions` (weâ€™ll explain next)
  - `eb setenv` command

âœ… **Data is preserved** even if EB is terminated. You can reuse the RDS across multiple EB environments.

> ğŸ§ª **Best for**: Production, staging, or any environment where **data durability** is critical.

---

### ğŸ¤Ÿ Option 3 â€“ **Manual Recovery Plan (Blue/Green + Snapshot Backup)**

This is your **disaster recovery & upgrade strategy**. Combine EB lifecycle control + RDS snapshots.

ğŸ“Œ **When to use this?**

- You want to deploy a **new version** of your EB app safely (blue/green)
- You want to **keep the same database**
- You want to **terminate old EB env** and clean up safely

### ğŸ§­ Steps

1. ğŸ“¸ **Snapshot** your RDS

   ```bash
   aws rds create-db-snapshot --db-instance-identifier mydb --db-snapshot-identifier mydb-snap
   ```

2. ğŸ” **Enable Delete Protection** on RDS (so even if EB tries to delete it, it fails)

3. ğŸ†• **Create a new EB environment** (new version of your app)

4. ğŸ”Œ In the new EB env, configure the same `RDS_HOSTNAME`, `USERNAME`, etc. (point to old DB)

5. ğŸ” **Swap the CNAME** between old and new EB envs

   ```bash
   eb swap --source-env old-env --dest-env new-env
   ```

6. ğŸ§¹ **Delete old EB environment**

   > Note: You may get `DELETE_FAILED` if EB tries to delete the RDS. Thatâ€™s fine â€” go to CloudFormation â†’ choose to _retain_ the RDS resource.

> ğŸ§ª **Best for**: Safe production migrations, disaster recovery, and preserving RDS across version swaps.

---

## ğŸ› ï¸ **Customize EB with `.ebextensions` â€“ Full Power Unleashed**

`.ebextensions` is your gateway to **configure**, **extend**, and **control** your Elastic Beanstalk environment.

ğŸ§© It's a folder inside your deployable ZIP bundle that includes `*.config` files written in **YAML or JSON**, following a **CloudFormation-style syntax**.

### ğŸ“ Folder structure

```ini
my-app.zip
â”œâ”€â”€ .ebextensions/
â”‚   â”œâ”€â”€ 01-env-vars.config
â”‚   â””â”€â”€ 02-custom-setup.config
â”œâ”€â”€ app.js
â””â”€â”€ package.json
```

---

### âš™ï¸ `.config` File Breakdown

#### âœ… 1. `option_settings`

Used to set config values for:

- Platform settings (like PHP memory limit)
- Env vars
- EC2 instance type
- Health check URL

```yaml
option_settings:
  aws:elasticbeanstalk:application:environment:
    MY_VAR: "value"
  aws:autoscaling:launchconfiguration:
    InstanceType: t3.small
```

---

#### ğŸ“¦ 2. `packages`, `sources`, `files`, `commands`

Used to:

- Install packages (yum, apt)
- Download files
- Write files
- Run shell commands on EC2

```yaml
packages:
  yum:
    git: []

commands:
  01_install:
    command: "npm install -g pm2"
```

---

#### ğŸ”§ 3. `Resources`

You can define **new AWS resources** (like S3 buckets, SNS topics) inside the EB stack using CloudFormation-style `Resources`.

```yaml
Resources:
  MyTopic:
    Type: AWS::SNS::Topic
    Properties:
      TopicName: my-eb-topic
```

---

#### ğŸš€ 4. `container_commands`

Runs **after the app is extracted** but **before the server starts**.

Useful for:

- Running `npm install`, `dotnet build`, etc.

```yaml
container_commands:
  01_npm_install:
    command: "npm install"
    leader_only: true
```

> ğŸ§  `leader_only: true` ensures it only runs on one instance during deploys.

---

## ğŸ§¬ **Cloning Elastic Beanstalk Environments**

Cloning allows you to **duplicate an EB environment** with:

- Same code version
- Same platform
- Same scaling & configuration

### ğŸ§ª Use Case

Test new changes in a **staging clone** of production.

```bash
eb clone my-prod-env
```

ğŸ’¡ Notes:

- âœ… Copies env vars, instance configs, scaling rules
- âŒ Doesnâ€™t copy **RDS data**
- âŒ Doesnâ€™t clone unmanaged changes (like manual EC2 tweaks)

> ğŸ§  Best for **blue/green deployments**, troubleshooting, testing changes.

---

## ğŸ³ **Running Docker Apps in Elastic Beanstalk**

<div align="center">
    <img src="images/aws-eb-with-docker.png" alt="AWS EB with Docker" style="border-radius: 10px; width: 70%;">
</div>

Elastic Beanstalk supports **Docker out-of-the-box**, in two major ways:

---

### ğŸ§± 1. **Single-Container Mode (EC2 + Docker)**

Elastic Beanstalk launches EC2 instances with Docker and runs a **single container per instance**.

You can use:

| File                    | Description                     |
| ----------------------- | ------------------------------- |
| `Dockerfile`            | Standard Dockerfile             |
| `Dockerrun.aws.json` v1 | Defines image + port + volumes  |
| `docker-compose.yml`    | Optional for multi-stage builds |

ğŸ“ All config files go in the **root of your zip bundle**.

---

### ğŸ§± 2. **Multi-Container Mode (ECS + EC2)**

Elastic Beanstalk creates:

- **ECS Cluster**
- EC2 Instances in cluster
- ELB (Load Balancer) in front

You must provide:

```json
// Dockerrun.aws.json (Version 2)
{
  "AWSEBDockerrunVersion": 2,
  "containerDefinitions": [
    {
      "name": "app",
      "image": "nginx",
      "memory": 128,
      "essential": true,
      "portMappings": [
        {
          "containerPort": 80
        }
      ]
    }
  ]
}
```

âœ… Use this for **more complex architectures**  
ğŸ§  Works well when moving toward ECS + EKS in future

## ğŸ§  Summary: Why Choose EB?

| âœ… Pros                                | âŒ Cons                                   |
| -------------------------------------- | ----------------------------------------- |
| Simple app deployment                  | Less control over individual AWS services |
| Built-in scaling, monitoring, and logs | No granular ECS/Fargate config            |
| Easy to integrate with GitHub/CD       | Not ideal for large enterprise teams      |
| Multi-platform support (.NET, Node.js) | Limited CI/CD flexibility                 |

---

> âš ï¸ **Note**:  
> For complete control over infrastructure configuration, consider using **AWS CloudFormation** instead. However, CloudFormation provides minimal visibility into application and code management compared to Elastic Beanstalk.
