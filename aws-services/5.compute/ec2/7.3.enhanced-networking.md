# âš¡ **Enhanced Networking in Amazon EC2**

> _Unlock high performance, low-latency networking for your EC2 instances._

---

## ğŸš€ **What Is Enhanced Networking?**

**Enhanced Networking** uses **Single Root I/O Virtualization (SR-IOV)** to deliver:

- ğŸŒ Higher **network bandwidth** (up to 100 Gbps)
- ğŸš€ Lower **network latency**
- ğŸ“¦ Higher **packets per second (PPS)**
- âœ… Lower CPU overhead for networking

---

## ğŸ§© **Two Types of Enhanced Networking**

### ğŸ”¹ **1. Elastic Network Adapter (ENA)** â€” _Modern, high-throughput_

- **Used by most current-generation instance types**
- **Up to 100 Gbps** of network throughput
- Supports:

  - IPv4 / IPv6
  - Jumbo frames
  - Placement Groups
  - Scalable network traffic

**ğŸ”§ Supported Instance Types:**
`C5`, `M5`, `R5`, `T3`, `T4g`, `P4`, `Inf1`, `Graviton` families and newer.

---

### ğŸ”¹ **2. Intel 82599 VF (Virtual Function)** â€” _Legacy_

- **Older networking option**, up to 10 Gbps
- Based on Intelâ€™s 82599 SR-IOV VF interface
- Now mostly replaced by ENA

**ğŸ”§ Supported Instance Types (legacy):**
`C3`, `R3`, `I2`, `M3` families

---

## ğŸ§ª **3. Elastic Fabric Adapter (EFA)** â€” _Ultra-low latency for HPC_

> _Built on top of ENA but optimized for tightly coupled, distributed HPC and ML workloads._

- Supports **Message Passing Interface (MPI)** workloads
- **Bypasses the Linux kernel networking stack**
- Delivers **low-latency**, **high-throughput** connections between EC2 instances

**ğŸ“Œ Best For:**

- High Performance Computing (HPC)
- Machine learning model training (e.g., PyTorch DDP)
- Scientific simulations and CFD workloads

**ğŸ”§ Supported Only On:**

- Select **Linux AMIs**
- Instance types like `C5n`, `P4d`, `Inf1`, `Hpc6a`, `Trn1`, etc.

---

## ğŸ§° **How to Enable Enhanced Networking**

### âœ… ENA Setup (Modern)

**Step 1:** Check ENA support for your instance and AMI:

```bash
ethtool -i eth0
```

**Expected output:**

```ini
driver: ena
```

**Step 2:** If not enabled, you can **modify the instance attribute** via AWS CLI:

```bash
aws ec2 modify-instance-attribute --instance-id i-0abcd1234ef567890 --ena-support
```

**Step 3:** Ensure correct ENA module is installed:

```bash
modinfo ena
```

---

### âœ… EFA Setup Example

**1. Install EFA drivers (on Amazon Linux 2 / Ubuntu):**

```bash
curl -O https://efa-installer.amazonaws.com/aws-efa-installer-latest.tar.gz
tar -xf aws-efa-installer-latest.tar.gz
cd aws-efa-installer
sudo ./efa_installer.sh -y
```

**2. Confirm EFA device appears:**

```bash
fi_info -p efa
```

**3. Use MPI for distributed training:**

```bash
mpirun -n 4 -hostfile hosts python train.py
```

---

## ğŸ“ˆ **When Should You Use Enhanced Networking?**

| ğŸ’¼ **Scenario**                           | âœ… **Use**                |
| ----------------------------------------- | ------------------------- |
| High throughput web servers               | ENA                       |
| Real-time gaming or streaming             | ENA                       |
| Distributed ML model training (e.g., DDP) | EFA                       |
| Weather simulations / CFD / genomics      | EFA                       |
| Batch processing with low-latency needs   | ENA or EFA                |
| Legacy applications on older instances    | Intel 82599 VF (fallback) |

---

## ğŸ§  **Final Tips**

- ğŸ“ Always **use Placement Groups** (cluster strategy) with EFA to reduce latency between nodes.
- ğŸ§ª **Benchmark networking** with `iperf3` to compare baseline vs. enhanced mode.
- ğŸ›¡ï¸ **Monitor performance** via CloudWatch Network metrics:

  - `NetworkPacketsIn/Out`
  - `NetworkIn/Out`
  - `NetworkInterfaceErrors`
