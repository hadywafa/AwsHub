# ğŸ”„ **AWS Lambda Triggers vs. Destinations**

AWS Lambda is fundamentally **event-driven** â€” it executes **in response to events**, not in isolation. But thereâ€™s a crucial distinction between:

- âœ… **Triggers** â€“ Define **when** Lambda runs
- ğŸ” **Destinations** â€“ Define **what happens after** Lambda runs (for async)

---

<div style="text-align: center;">
    <img src="images/who-can-triggers-lambda-function.png" alt="Who Can Trigger Lambda" style="border-radius: 10px; width: 90%;" />
</div>

---

## âš¡ **What Are AWS Lambda Triggers?**

A **trigger** tells Lambda:

> â€œğŸ“£ When this event happens â€” run this function!â€

### ğŸ“¡ Who Can Trigger Lambda?

| ğŸ§© Source            | ğŸ” Example Trigger Scenario                 |
| -------------------- | ------------------------------------------- |
| **S3**               | New file uploaded â†’ image processing Lambda |
| **API Gateway**      | HTTP request â†’ Lambda as backend            |
| **SNS**              | Message publish â†’ trigger processing Lambda |
| **SQS**              | New queue message â†’ async job processing    |
| **EventBridge**      | Scheduled rule or event pattern â†’ Lambda    |
| **Kinesis / Kafka**  | Stream message â†’ real-time analytics        |
| **DynamoDB Streams** | Table item modified â†’ sync secondary table  |
| **Cognito**          | User signup/signin â†’ validation hook        |
| **CloudFront**       | Viewer request â†’ Lambda\@Edge               |
| **Step Functions**   | Lambda used as a task in workflow           |
| **Function URLs**    | Direct HTTP call â†’ invoke Lambda securely   |
| **Others**           | SES, IoT, Lex, Alexa, etc.                  |

---

### ğŸ› ï¸ **How Do Triggers Work?**

**1ï¸âƒ£** Event source detects an event  
**2ï¸âƒ£** Sends data to Lambda  
**3ï¸âƒ£** Lambda executes with the event as payload

<div align="center">

```mermaid
sequenceDiagram
    participant S3
    participant Lambda
    S3->>Lambda: ObjectCreated Event
    Lambda->>Lambda: Execute handler
    Lambda-->>S3: Done (async)
```

</div>

---

## ğŸ§ª **Real Example: S3 Trigger + Lambda**

### ğŸ§± Step 1: S3 Sends Events to Lambda

```bash
aws s3api put-bucket-notification-configuration \
  --bucket my-bucket \
  --notification-configuration '{
    "LambdaFunctionConfigurations": [
      {
        "LambdaFunctionArn": "arn:aws:lambda:us-east-1:123456789012:function:myFunction",
        "Events": ["s3:ObjectCreated:*"]
      }
    ]
  }'
```

### ğŸ” Step 2: Allow S3 to Invoke Lambda

```bash
aws lambda add-permission \
  --function-name myFunction \
  --statement-id AllowS3Invoke \
  --action "lambda:InvokeFunction" \
  --principal s3.amazonaws.com \
  --source-arn arn:aws:s3:::my-bucket \
  --source-account 123456789012
```

> âœ… Now Lambda is ready to react to new files in the bucket.

---

## ğŸ›°ï¸ **What Are AWS Lambda Destinations?**

**Destinations** define **where Lambda sends the result of an asynchronous invocation**, based on success or failure.

Think of it like this:

> ğŸ›« Trigger fires Lambda â†’ Lambda executes â†’ ğŸ›¬ Result goes to destination

---

### ğŸ§­ Supported Destinations

| Result            | Possible Destinations                             |
| ----------------- | ------------------------------------------------- |
| **On Success** âœ… | SNS topic, SQS queue, EventBridge, another Lambda |
| **On Failure** âŒ | SNS topic, SQS queue, EventBridge, another Lambda |

---

### ğŸ› ï¸ **Example: Send Success/Failure to SNS + SQS**

```bash
aws lambda put-function-event-invoke-config \
  --function-name myFunction \
  --destination-config '{
      "OnSuccess": {
          "Destination": "arn:aws:sns:us-east-1:123456789012:SuccessTopic"
      },
      "OnFailure": {
          "Destination": "arn:aws:sqs:us-east-1:123456789012:FailureQueue"
      }
  }'
```

> ğŸŸ¢ **Success â†’ SNS**  
> ğŸ”´ **Failure â†’ SQS**

Perfect for building post-execution flows like:

- Notifications
- Chaining Lambdas
- Dead-letter handling
- Real-time dashboards

---

## ğŸ¯ **Triggers vs. Destinations: What's the Difference?**

| Feature                    | **Triggers**                      | **Destinations**                                  |
| -------------------------- | --------------------------------- | ------------------------------------------------- |
| **Purpose**                | Start function execution          | Handle the result after function finishes         |
| **Type**                   | Event Source â†’ Lambda             | Lambda â†’ External target (after async execution)  |
| **Works with**             | All Lambda types                  | Only **asynchronous** Lambda invocations          |
| **Common Use Cases**       | S3 â†’ Lambda, API Gateway â†’ Lambda | Lambda â†’ SQS/SNS/EventBridge (on success/failure) |
| **Configuration Location** | Event source or Lambda console    | Lambda functionâ€™s **invoke config**               |

---

## ğŸ” **Resource-Based Policies: The Missing Piece**

Even if you configure a **trigger**, the source **must be allowed** to invoke the Lambda. Thatâ€™s where **resource-based policies** come in.

### ğŸ§  **Think of it like this:**

> ğŸ”” Trigger = â€œYouâ€™re allowed to call Lambdaâ€  
> ğŸ’‚ Policy = â€œYouâ€™re authorized to call Lambdaâ€

---

### ğŸ›  Example: Allow Another AWS Account or Service

```bash
aws lambda add-permission \
  --function-name myFunction \
  --statement-id AllowExternal \
  --action "lambda:InvokeFunction" \
  --principal sns.amazonaws.com \
  --source-arn arn:aws:sns:us-east-1:123456789012:MySNSTopic
```

> âœ… SNS now has permission to trigger Lambda.

---

## ğŸ§ª **When Do You Only Need a Resource-Based Policy?**

You **donâ€™t need a trigger** if you are:

- Allowing **manual invocation** from another AWS account
- Letting **Step Functions**, **CLI**, or **SDK** call your function directly
- Securing **Lambda Function URLs** (HTTP endpoints)

---

## ğŸ§© Final Recap â€“ Know When to Use What

| ğŸ§  Scenario                                 | Trigger Needed | Destination Needed | Resource Policy Needed |
| ------------------------------------------- | -------------- | ------------------ | ---------------------- |
| S3 triggers Lambda                          | âœ…             | âŒ                 | âœ…                     |
| Lambda sends result to SQS on failure       | âŒ             | âœ…                 | âœ…                     |
| API Gateway invokes Lambda on HTTP request  | âœ…             | âŒ                 | âœ…                     |
| Step Function invokes Lambda task           | âŒ             | âŒ                 | âœ…                     |
| Manually invoke Lambda from another account | âŒ             | âŒ                 | âœ…                     |

---

## ğŸš€ **Pro Tip: Build Event-Driven Workflows**

You can combine:

- **Trigger â†’ Lambda â†’ Destination â†’ Queue â†’ Next Lambda**
- **Trigger â†’ Lambda â†’ DLQ â†’ Analysis**

ğŸ’¡ This enables **chaining**, **error handling**, and **buffering**, all without servers.
